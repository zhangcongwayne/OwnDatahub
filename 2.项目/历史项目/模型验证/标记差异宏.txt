Sub 标记差异()
Dim i, j, rown, color
'rown = UsedRange.Cols.Count
rown = ActiveSheet.UsedRange.Columns.Count
color = 3


'指定列自动调整列宽
Application.ScreenUpdating = False
ActiveSheet.Range(Columns(5), Columns(rown)).EntireColumn.WrapText = False
ActiveSheet.Range(Columns(5), Columns(rown)).EntireColumn.AutoFit
Application.ScreenUpdating = True

'选定整个表格
ActiveSheet.UsedRange.Select
'设置边框
With Selection
    .Borders(xlEdgeLeft).LineStyle = xlContinuous
    .Borders(xlEdgeTop).LineStyle = xlContinuous
    .Borders(xlEdgeBottom).LineStyle = xlContinuous
    .Borders(xlEdgeRight).LineStyle = xlContinuous
    .Borders(xlInsideVertical).LineStyle = xlContinuous
    .Borders(xlInsideHorizontal).LineStyle = xlContinuous
End With

For i = 2 To ActiveSheet.UsedRange.Rows.Count
    
    For s = 1 To rown
        Cells(i, s).Interior.ColorIndex = 2 '涂颜色
    Next
    
    If (i Mod 2 = 1 And Cells(i, 3) = Cells(i - 1, 3)) Then
        j = 6
        While (j <= rown)
           If Abs(Cells(i, j) - Cells(i - 1, j)) > 0.00001 Then
                Cells(i, j).Interior.ColorIndex = color '涂颜色
                Cells(i - 1, j).Interior.ColorIndex = color '涂颜色
           End If
           j = j + 1
        Wend
        
        If color < 4 Then
            color = color + 1
        Else
            color = 3
        End If

    End If
    
    If (Cells(i, 3) <> Cells(i - 1, 3) And Cells(i, 3) <> Cells(i + 1, 3)) Then
        For s = 1 To rown
            Cells(i, s).Interior.ColorIndex = 8 '涂颜色
        Next
    End If
    
Next
End Sub

